<Window x:Class="AI.KB.Assistant.Views.SettingsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="設定" Height="700" Width="900"
        WindowStartupLocation="CenterOwner"
        Background="#0b1220" Foreground="#f4f4f4"
        FontFamily="Segoe UI, Microsoft JhengHei">

    <DockPanel>
        <!-- 底部按鈕列 -->
        <Border DockPanel.Dock="Bottom" Background="#0f1628" Padding="10">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Right">
                <Button Content="取消" Width="100" Margin="0,0,8,0" Click="Cancel_Click"/>
                <Button Content="儲存" Width="120" Click="Save_Click"/>
            </StackPanel>
        </Border>

        <ScrollViewer VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="20">

                <!-- ===== App ===== -->
                <TextBlock Text="應用程式" FontSize="18" FontWeight="SemiBold" Margin="0,0,0,8"/>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="根目錄：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtRootDir" Width="520"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="收件匣：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtInboxDir" Width="520"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="資料庫：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtDbPath" Width="520"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="搬移模式：" Width="160" VerticalAlignment="Center"/>
                    <ComboBox x:Name="CmbMoveMode" Width="180">
                        <ComboBoxItem Content="移動 (move)"/>
                        <ComboBoxItem Content="複製 (copy)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="覆寫策略：" Width="160" VerticalAlignment="Center"/>
                    <ComboBox x:Name="CmbOverwrite" Width="220">
                        <ComboBoxItem Content="覆寫 (overwrite)"/>
                        <ComboBoxItem Content="略過 (skip)"/>
                        <ComboBoxItem Content="重新命名 (rename)"/>
                    </ComboBox>
                </StackPanel>

                <CheckBox x:Name="ChkDryRun" Content="乾跑（只模擬不搬檔）" Margin="160,4,0,8"/>

                <Separator Margin="0,8"/>

                <!-- ===== 路徑與分類風格 ===== -->
                <TextBlock Text="路徑與分類風格" FontSize="18" FontWeight="SemiBold" Margin="0,8,0,8"/>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="分類風格：" Width="160" VerticalAlignment="Center"/>
                    <!-- 顯示中文；Tag 為程式實際值 -->
                    <ComboBox x:Name="CmbClassificationMode" Width="320">
                        <ComboBoxItem Content="類別分類（依主題）"           Tag="Category"/>
                        <ComboBoxItem Content="日期分類（年/月）"             Tag="Date"/>
                        <ComboBoxItem Content="專案分類（以專案分層）"       Tag="Project"/>
                        <ComboBoxItem Content="檔案類型分類（副檔名）"       Tag="FileType"/>
                        <ComboBoxItem Content="時間軸分類（年/季/月/週）"     Tag="TimePeriod"/>
                        <ComboBoxItem Content="混合：專案→年→類別"          Tag="Hybrid"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="時間粒度（TimePeriod）：" Width="160" VerticalAlignment="Center"/>
                    <ComboBox x:Name="CmbTimeGranularity" Width="320">
                        <ComboBoxItem Content="年"   Tag="Year"/>
                        <ComboBoxItem Content="季"   Tag="Quarter"/>
                        <ComboBoxItem Content="月"   Tag="Month"/>
                        <ComboBoxItem Content="週"   Tag="Week"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="預設專案名稱：" Width="160" VerticalAlignment="Center"/>
                    <ComboBox x:Name="CmbDefaultProject" Width="320" IsEditable="True"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="專案清單（逗號分隔）：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtProjects" Width="520" ToolTip="例：Default, 專案A, SideProject"/>
                </StackPanel>

                <Separator Margin="0,8"/>

                <!-- ===== AI 分類設定（保留） ===== -->
                <TextBlock Text="AI 分類設定" FontSize="18" FontWeight="SemiBold" Margin="0,8,0,8"/>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="引擎：" Width="160" VerticalAlignment="Center"/>
                    <ComboBox x:Name="CmbEngine" Width="180">
                        <ComboBoxItem Content="本地規則 (dummy)"/>
                        <ComboBoxItem Content="OpenAI (llm)"/>
                        <ComboBoxItem Content="混合 (hybrid)"/>
                    </ComboBox>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="風格提示：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtStyle" Width="520"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="信心度 (0~1)：" Width="160" VerticalAlignment="Center"/>
                    <Slider x:Name="SldThreshold" Minimum="0" Maximum="1" Width="320" TickFrequency="0.05" IsSnapToTickEnabled="True"/>
                    <TextBlock x:Name="LblThreshold" Width="80" Margin="8,0,0,0" VerticalAlignment="Center"/>
                </StackPanel>

                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="預設類別：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtFallback" Width="320"/>
                </StackPanel>

                <TextBlock Text="自訂分類白名單：" Margin="0,8,0,4"/>
                <StackPanel Orientation="Horizontal">
                    <TextBox x:Name="TxtNewTag" Width="320"/>
                    <Button Content="新增" Width="80" Margin="8,0,0,0" Click="AddTag_Click"/>
                    <Button Content="移除所選" Width="100" Margin="8,0,0,0" Click="RemoveTag_Click"/>
                </StackPanel>
                <ListBox x:Name="LstTaxonomy" Height="120" Margin="0,4,0,0"/>

                <Separator Margin="0,8"/>

                <!-- ===== OpenAI（保留） ===== -->
                <TextBlock Text="OpenAI" FontSize="18" FontWeight="SemiBold" Margin="0,8,0,8"/>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="模型：" Width="160" VerticalAlignment="Center"/>
                    <TextBox x:Name="TxtModel" Width="240"/>
                </StackPanel>
                <StackPanel Orientation="Horizontal" Margin="0,4">
                    <TextBlock Text="API Key：" Width="160" VerticalAlignment="Center"/>
                    <PasswordBox x:Name="PwdApiKey" Width="320"/>
                </StackPanel>

                <Rectangle Height="8" Fill="Transparent"/>
            </StackPanel>
        </ScrollViewer>
    </DockPanel>
</Window>
