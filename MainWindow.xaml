<Window x:Class="AI.KB.Assistant.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:conv="clr-namespace:AI.KB.Assistant.Helpers"
        Title="AI 知識庫助手" Height="720" Width="1200"
        Background="#0b1220" Foreground="#f4f4f4"
        FontFamily="Segoe UI, Microsoft JhengHei">

    <Window.Resources>
        <conv:UnixToDateConverter x:Key="UnixToDateConverter"/>
        <!-- ListView 的簡易樣式 -->
        <Style TargetType="ListViewItem">
            <Setter Property="Foreground" Value="White"/>
            <Setter Property="Background" Value="#0f1628"/>
        </Style>
        <Style TargetType="Button">
            <Setter Property="Margin" Value="8"/>
            <Setter Property="Padding" Value="6,4"/>
        </Style>
        <Style TargetType="TextBox">
            <Setter Property="Margin" Value="0,0,8,0"/>
        </Style>
        <Style TargetType="CheckBox">
            <Setter Property="Margin" Value="0,0,12,0"/>
        </Style>
    </Window.Resources>

    <DockPanel>

        <!-- 側邊欄 -->
        <StackPanel DockPanel.Dock="Left" Width="260" Background="#111a2b">
            <TextBlock Text="AI 知識庫側欄" Margin="12" Foreground="White" FontWeight="Bold"/>

            <TextBlock Text="總目錄" Margin="12,6,12,0" Foreground="#cfe3ff"/>
            <TreeView Name="TreeCategories" Margin="8"/>

            <Separator Margin="8"/>

            <!-- 搜尋列 -->
            <TextBlock Text="搜尋" Margin="12,4,12,0" Foreground="#cfe3ff"/>
            <StackPanel Orientation="Horizontal" Margin="8">
                <TextBox Name="SearchBox" Width="160" KeyDown="SearchBox_KeyDown"/>
                <Button Name="BtnSearch" Content="🔍" Width="44" Click="BtnSearch_Click"/>
            </StackPanel>

            <!-- 快速視圖 -->
            <Button Name="BtnRecent"   Content="🆕 最近新增" Click="BtnRecent_Click"/>
            <Button Name="BtnPending"  Content="📝 待確認"   Click="BtnPending_Click"/>
            <Button Name="BtnProgress" Content="🚀 執行中"   Click="BtnProgress_Click"/>
            <Button Name="BtnTodo"     Content="✅ 代辦"     Click="BtnTodo_Click"/>
            <Button Name="BtnSettings" Content="⚙️ 設定"     Click="BtnSettings_Click"/>
        </StackPanel>

        <!-- 主區域 -->
        <DockPanel>
            <StackPanel Orientation="Horizontal" Margin="8">
                <CheckBox Name="ChkDryRun" Content="乾跑" IsChecked="True"/>
                <Button Name="BtnConfirmMove" Content="🟢 一鍵確認並搬檔"
                        Margin="12,0,0,0" Click="BtnConfirmMove_Click"/>
                <TextBlock Name="TxtLog" Margin="16,0,0,0" VerticalAlignment="Center" Foreground="#9ec2ff"/>
            </StackPanel>

            <Border Margin="8" BorderBrush="#2e7cf6" BorderThickness="1" Padding="16"
                    AllowDrop="True" Drop="DropInbox" Background="#0f1628" CornerRadius="8">
                <TextBlock Foreground="#cfe3ff" FontSize="16"
                           Text="把檔案拖進來（收件匣）"
                           HorizontalAlignment="Center" VerticalAlignment="Center" />
            </Border>

            <!-- 清單 -->
            <ListView Name="ListFiles" Margin="8" SelectionMode="Extended">
                <ListView.View>
                    <GridView>
                        <GridViewColumn Header="檔名"    Width="360" DisplayMemberBinding="{Binding Filename}"/>
                        <GridViewColumn Header="類別"    Width="120" DisplayMemberBinding="{Binding Category}"/>
                        <GridViewColumn Header="日期"    Width="120">
                            <GridViewColumn.CellTemplate>
                                <DataTemplate>
                                    <TextBlock Text="{Binding CreatedTs, Converter={StaticResource UnixToDateConverter}}"/>
                                </DataTemplate>
                            </GridViewColumn.CellTemplate>
                        </GridViewColumn>
                        <GridViewColumn Header="信心"    Width="80"  DisplayMemberBinding="{Binding Confidence}"/>
                        <GridViewColumn Header="摘要"    Width="420" DisplayMemberBinding="{Binding Summary}"/>
                    </GridView>
                </ListView.View>
            </ListView>
        </DockPanel>
    </DockPanel>
</Window>
